{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/tomoh.ikfingeh/Downloads/rise4impact_starter/nextjs-app/src/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from '@prisma/client'\r\n\r\nconst globalForPrisma = globalThis as unknown as {\r\n  prisma: PrismaClient | undefined\r\n}\r\n\r\nexport const prisma = globalForPrisma.prisma ?? new PrismaClient()\r\n\r\nif (process.env.NODE_ENV !== 'production') globalForPrisma.prisma = prisma\r\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,kBAAkB;AAIjB,MAAM,SAAS,gBAAgB,MAAM,IAAI,IAAI,sMAAY;AAEhE,wCAA2C,gBAAgB,MAAM,GAAG"}},
    {"offset": {"line": 119, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/tomoh.ikfingeh/Downloads/rise4impact_starter/nextjs-app/src/lib/auth.ts"],"sourcesContent":["import type { NextAuthOptions } from 'next-auth'\r\nimport type { JWT } from 'next-auth/jwt'\r\nimport type { Session, User } from 'next-auth'\r\nimport CredentialsProvider from 'next-auth/providers/credentials'\r\nimport bcrypt from 'bcryptjs'\r\nimport { prisma } from './prisma'\r\n\r\nexport const authOptions: NextAuthOptions = {\r\n  providers: [\r\n    CredentialsProvider({\r\n      name: 'Credentials',\r\n      credentials: {\r\n        email: { label: 'Email', type: 'email' },\r\n        password: { label: 'Password', type: 'password' },\r\n      },\r\n      async authorize(credentials) {\r\n        if (!credentials?.email || !credentials?.password) {\r\n          throw new Error('Invalid credentials')\r\n        }\r\n\r\n        const admin = await prisma.admin.findUnique({\r\n          where: { email: credentials.email },\r\n        })\r\n\r\n        if (!admin) {\r\n          throw new Error('No user found with this email')\r\n        }\r\n\r\n        const isPasswordValid = await bcrypt.compare(\r\n          credentials.password as string,\r\n          admin.password\r\n        )\r\n\r\n        if (!isPasswordValid) {\r\n          throw new Error('Invalid password')\r\n        }\r\n\r\n        return {\r\n          id: admin.id.toString(),\r\n          email: admin.email,\r\n          name: admin.name || admin.email,\r\n          role: admin.role,\r\n        } as User & { role: string }\r\n      },\r\n    }),\r\n  ],\r\n  session: {\r\n    strategy: 'jwt',\r\n  },\r\n  pages: {\r\n    signIn: '/admin/login',\r\n    error: '/admin/login',\r\n  },\r\n  debug: false,\r\n  logger: {\r\n    error: () => {}, // Suppress NextAuth errors in console\r\n    warn: () => {},\r\n    debug: () => {},\r\n  },\r\n  callbacks: {\r\n    async jwt({ token, user }: { token: JWT; user?: User & { role?: string } }) {\r\n      if (user) {\r\n        token.role = user.role\r\n      }\r\n      return token\r\n    },\r\n    async session({ session, token }: { session: Session; token: JWT }) {\r\n      if (session?.user) {\r\n        session.user.role = token.role as string\r\n      }\r\n      return session\r\n    },\r\n  },\r\n  secret: process.env.NEXTAUTH_SECRET || 'your-secret-key-here-change-in-production',\r\n}\r\n"],"names":[],"mappings":";;;;AAGA;AACA;AACA;;;;AAEO,MAAM,cAA+B;IAC1C,WAAW;QACT,IAAA,qKAAmB,EAAC;YAClB,MAAM;YACN,aAAa;gBACX,OAAO;oBAAE,OAAO;oBAAS,MAAM;gBAAQ;gBACvC,UAAU;oBAAE,OAAO;oBAAY,MAAM;gBAAW;YAClD;YACA,MAAM,WAAU,WAAW;gBACzB,IAAI,CAAC,aAAa,SAAS,CAAC,aAAa,UAAU;oBACjD,MAAM,IAAI,MAAM;gBAClB;gBAEA,MAAM,QAAQ,MAAM,gIAAM,CAAC,KAAK,CAAC,UAAU,CAAC;oBAC1C,OAAO;wBAAE,OAAO,YAAY,KAAK;oBAAC;gBACpC;gBAEA,IAAI,CAAC,OAAO;oBACV,MAAM,IAAI,MAAM;gBAClB;gBAEA,MAAM,kBAAkB,MAAM,8IAAM,CAAC,OAAO,CAC1C,YAAY,QAAQ,EACpB,MAAM,QAAQ;gBAGhB,IAAI,CAAC,iBAAiB;oBACpB,MAAM,IAAI,MAAM;gBAClB;gBAEA,OAAO;oBACL,IAAI,MAAM,EAAE,CAAC,QAAQ;oBACrB,OAAO,MAAM,KAAK;oBAClB,MAAM,MAAM,IAAI,IAAI,MAAM,KAAK;oBAC/B,MAAM,MAAM,IAAI;gBAClB;YACF;QACF;KACD;IACD,SAAS;QACP,UAAU;IACZ;IACA,OAAO;QACL,QAAQ;QACR,OAAO;IACT;IACA,OAAO;IACP,QAAQ;QACN,OAAO,KAAO;QACd,MAAM,KAAO;QACb,OAAO,KAAO;IAChB;IACA,WAAW;QACT,MAAM,KAAI,EAAE,KAAK,EAAE,IAAI,EAAmD;YACxE,IAAI,MAAM;gBACR,MAAM,IAAI,GAAG,KAAK,IAAI;YACxB;YACA,OAAO;QACT;QACA,MAAM,SAAQ,EAAE,OAAO,EAAE,KAAK,EAAoC;YAChE,IAAI,SAAS,MAAM;gBACjB,QAAQ,IAAI,CAAC,IAAI,GAAG,MAAM,IAAI;YAChC;YACA,OAAO;QACT;IACF;IACA,QAAQ,QAAQ,GAAG,CAAC,eAAe,IAAI;AACzC"}},
    {"offset": {"line": 201, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/tomoh.ikfingeh/Downloads/rise4impact_starter/nextjs-app/src/app/api/opportunities/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server'\r\nimport { prisma } from '@/lib/prisma'\r\nimport { getServerSession } from 'next-auth'\r\nimport { authOptions } from '@/lib/auth'\r\n\r\n// GET - Fetch all opportunities (public - no auth required)\r\nexport async function GET(request: Request) {\r\n  try {\r\n    const { searchParams } = new URL(request.url)\r\n    const activeOnly = searchParams.get('activeOnly') === 'true'\r\n    const featuredOnly = searchParams.get('featuredOnly') === 'true'\r\n\r\n    const where: any = {}\r\n    if (activeOnly) where.isActive = true\r\n    if (featuredOnly) where.isFeatured = true\r\n\r\n    const opportunities = await prisma.opportunity.findMany({\r\n      where,\r\n      orderBy: { createdAt: 'desc' },\r\n    })\r\n\r\n    return NextResponse.json(opportunities)\r\n  } catch (error) {\r\n    console.error('Error fetching opportunities:', error)\r\n    return NextResponse.json(\r\n      { error: 'Failed to fetch opportunities' },\r\n      { status: 500 }\r\n    )\r\n  }\r\n}\r\n\r\n// POST - Create new opportunity (admin only)\r\nexport async function POST(request: Request) {\r\n  try {\r\n    // Check authentication\r\n    const session = await getServerSession(authOptions)\r\n    if (!session) {\r\n      return NextResponse.json({ error: 'Unauthorized' }, { status: 401 })\r\n    }\r\n\r\n    const body = await request.json()\r\n\r\n    // Validate required fields\r\n    if (!body.title || !body.description || !body.applyLink) {\r\n      return NextResponse.json(\r\n        { error: 'Title, description, and apply link are required' },\r\n        { status: 400 }\r\n      )\r\n    }\r\n\r\n    const opportunity = await prisma.opportunity.create({\r\n      data: {\r\n        title: body.title,\r\n        description: body.description,\r\n        organization: body.organization || null,\r\n        deadline: body.deadline || null,\r\n        eligibility: body.eligibility || null,\r\n        benefits: body.benefits || null,\r\n        applyLink: body.applyLink,\r\n        image: body.image || null,\r\n        categories: body.categories ? JSON.stringify(body.categories) : null,\r\n        location: body.location || null,\r\n        isPaid: body.isPaid || false,\r\n        isActive: body.isActive !== undefined ? body.isActive : true,\r\n        isFeatured: body.isFeatured || false,\r\n      },\r\n    })\r\n\r\n    // Send email notification to all subscribers (non-blocking)\r\n    if (body.isActive && body.isFeatured) {\r\n      // Only send email if opportunity is active and featured\r\n      const { notifySubscribersNewOpportunity } = await import('@/lib/email-notifications')\r\n      const categoriesArray = body.categories || []\r\n      notifySubscribersNewOpportunity({\r\n        title: opportunity.title,\r\n        description: opportunity.description,\r\n        organization: opportunity.organization,\r\n        deadline: opportunity.deadline,\r\n        image: opportunity.image,\r\n        applyLink: opportunity.applyLink,\r\n        category: categoriesArray.length > 0 ? categoriesArray.join(', ') : null,\r\n      }).catch((error) => {\r\n        console.error('Failed to send opportunity notification:', error)\r\n      })\r\n    }\r\n\r\n    return NextResponse.json(opportunity, { status: 201 })\r\n  } catch (error) {\r\n    console.error('Error creating opportunity:', error)\r\n    return NextResponse.json(\r\n      { error: 'Failed to create opportunity' },\r\n      { status: 500 }\r\n    )\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AACA;AACA;;;;;AAGO,eAAe,IAAI,OAAgB;IACxC,IAAI;QACF,MAAM,EAAE,YAAY,EAAE,GAAG,IAAI,IAAI,QAAQ,GAAG;QAC5C,MAAM,aAAa,aAAa,GAAG,CAAC,kBAAkB;QACtD,MAAM,eAAe,aAAa,GAAG,CAAC,oBAAoB;QAE1D,MAAM,QAAa,CAAC;QACpB,IAAI,YAAY,MAAM,QAAQ,GAAG;QACjC,IAAI,cAAc,MAAM,UAAU,GAAG;QAErC,MAAM,gBAAgB,MAAM,gIAAM,CAAC,WAAW,CAAC,QAAQ,CAAC;YACtD;YACA,SAAS;gBAAE,WAAW;YAAO;QAC/B;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;IAC3B,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,iCAAiC;QAC/C,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAAgC,GACzC;YAAE,QAAQ;QAAI;IAElB;AACF;AAGO,eAAe,KAAK,OAAgB;IACzC,IAAI;QACF,uBAAuB;QACvB,MAAM,UAAU,MAAM,IAAA,2JAAgB,EAAC,mIAAW;QAClD,IAAI,CAAC,SAAS;YACZ,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAe,GAAG;gBAAE,QAAQ;YAAI;QACpE;QAEA,MAAM,OAAO,MAAM,QAAQ,IAAI;QAE/B,2BAA2B;QAC3B,IAAI,CAAC,KAAK,KAAK,IAAI,CAAC,KAAK,WAAW,IAAI,CAAC,KAAK,SAAS,EAAE;YACvD,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAkD,GAC3D;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,cAAc,MAAM,gIAAM,CAAC,WAAW,CAAC,MAAM,CAAC;YAClD,MAAM;gBACJ,OAAO,KAAK,KAAK;gBACjB,aAAa,KAAK,WAAW;gBAC7B,cAAc,KAAK,YAAY,IAAI;gBACnC,UAAU,KAAK,QAAQ,IAAI;gBAC3B,aAAa,KAAK,WAAW,IAAI;gBACjC,UAAU,KAAK,QAAQ,IAAI;gBAC3B,WAAW,KAAK,SAAS;gBACzB,OAAO,KAAK,KAAK,IAAI;gBACrB,YAAY,KAAK,UAAU,GAAG,KAAK,SAAS,CAAC,KAAK,UAAU,IAAI;gBAChE,UAAU,KAAK,QAAQ,IAAI;gBAC3B,QAAQ,KAAK,MAAM,IAAI;gBACvB,UAAU,KAAK,QAAQ,KAAK,YAAY,KAAK,QAAQ,GAAG;gBACxD,YAAY,KAAK,UAAU,IAAI;YACjC;QACF;QAEA,4DAA4D;QAC5D,IAAI,KAAK,QAAQ,IAAI,KAAK,UAAU,EAAE;YACpC,wDAAwD;YACxD,MAAM,EAAE,+BAA+B,EAAE,GAAG;YAC5C,MAAM,kBAAkB,KAAK,UAAU,IAAI,EAAE;YAC7C,gCAAgC;gBAC9B,OAAO,YAAY,KAAK;gBACxB,aAAa,YAAY,WAAW;gBACpC,cAAc,YAAY,YAAY;gBACtC,UAAU,YAAY,QAAQ;gBAC9B,OAAO,YAAY,KAAK;gBACxB,WAAW,YAAY,SAAS;gBAChC,UAAU,gBAAgB,MAAM,GAAG,IAAI,gBAAgB,IAAI,CAAC,QAAQ;YACtE,GAAG,KAAK,CAAC,CAAC;gBACR,QAAQ,KAAK,CAAC,4CAA4C;YAC5D;QACF;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC,aAAa;YAAE,QAAQ;QAAI;IACtD,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,+BAA+B;QAC7C,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAA+B,GACxC;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}